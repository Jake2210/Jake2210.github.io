<!DOCTYPE html>
<html>
  <head>
    <title>Flappy Bird Side Scroller</title>
    <style>
      canvas {
        border: 1px solid black;
        display: block;
        margin: 0 auto;
      }

      #restartButton {
        display: none;
      }
    </style>
  </head>
  <body>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <button id="restartButton">Restart</button>
    <script>
      // Get the canvas element
      const canvas = document.getElementById("gameCanvas");
      const context = canvas.getContext("2d");

      // Game variables
      let x = 50; // Initial x position
      let y = canvas.height / 2; // Initial y position
      let velocityY = 0; // Vertical velocity
      const gravity = 0.5; // Gravity force
      const jumpStrength = 10; // Strength of the jump
      let gameRunning = true;
      let pipes = [];
      const pipeGap = 100; // Gap between upper and lower pipes
      const pipeWidth = 50; // Width of the pipes
      const pipeDistance = 200; // Distance between consecutive pipes

      // Function to handle screen taps
      function handleTap() {
        if (gameRunning) {
          velocityY = -jumpStrength; // Set the upward velocity for the jump
        }
      }

      // Function to handle restart button click
      function restartGame() {
        x = 50;
        y = canvas.height / 2;
        velocityY = 0;
        gameRunning = true;
        pipes = [];
        restartButton.style.display = "none";
        generatePipe();
        update();
      }

      // Function to generate a new pipe
      function generatePipe() {
        const pipeX = canvas.width;
        const upperPipeHeight = Math.random() * (canvas.height - pipeGap);
        const lowerPipeHeight = canvas.height - pipeGap - upperPipeHeight;
        pipes.push({
          x: pipeX,
          upperY: 0,
          upperHeight: upperPipeHeight,
          lowerY: canvas.height - lowerPipeHeight,
          lowerHeight: lowerPipeHeight,
        });
      }

      // Update the game state
      function update() {
        // Clear the canvas
        context.clearRect(0, 0, canvas.width, canvas.height);

        // Update the vertical position based on the velocity
        y += velocityY;
        velocityY += gravity;

        // Draw the character
        context.fillStyle = "red";
        context.fillRect(x, y, 20, 20);

        // Update and draw the pipes
        pipes.forEach((pipe) => {
          pipe.x -= 2; // Adjust the pipe's horizontal position for movement

          // Draw the upper pipe
          context.fillStyle = "green";
          context.fillRect(pipe.x, pipe.upperY, pipeWidth, pipe.upperHeight);

          // Draw the lower pipe
          context.fillStyle = "green";
          context.fillRect(pipe.x, pipe.lowerY, pipeWidth, pipe.lowerHeight);

          // Check for collision with pipes
          if (
            x + 20 >= pipe.x &&
            x <= pipe.x + pipeWidth &&
            (y <= pipe.upperHeight || y + 20 >= pipe.lowerY)
          ) {
            gameRunning = false;
            restartButton.style.display = "block";
          }

          // Check if the character has passed through the pipes
          if (x > pipe.x + pipeWidth && pipe.x + pipeWidth > 0) {
            gameRunning = true;
          }
        });

        // Remove off-screen pipes
        if (pipes.length > 0 && pipes[0].x + pipeWidth < 0) {
          pipes.shift();
        }

        // Generate new pipes
        if (pipes.length === 0 || canvas.width - pipes[pipes.length - 1].x > pipeDistance) {
          generatePipe();
        }

        // Request animation frame to update the game state
        if (gameRunning) {
          requestAnimationFrame(update);
        }
      }

      // Event listener for screen taps
      canvas.addEventListener("click", handleTap);

      // Event listener for restart button click
      const restartButton = document.getElementById("restartButton");
      restartButton.addEventListener("click", restartGame);

      // Start the game loop
      generatePipe();
      update();
    </script>
  </body>
</html>
